{%TEMPLATE->struct/head%}
{%TEMPLATE->struct/menu%}
<h2>Hashlist details</h2>
{%TEMPLATE->struct/messages%}

{{IF [[zap]]}}
  {%TEMPLATE->hashlists/zap%}
{{ENDIF}}

<div class="card">
  <div class="table-responsive">
    <table class="table table-bordered table-sm align-middle mb-0">
      <thead>
        <tr>
          <th style="width: 32%;">Property</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>ID</td>
          <td><code>[[list.getVal('hashlist')->getId()]]</code></td>
        </tr>

        <tr>
          <td>Member of Access Group</td>
          <td>[[accessGroup.getGroupName()]]</td>
        </tr>

        <tr>
          <td>Name</td>
          <td>
            {{IF [[accessControl.hasPermission([[$DAccessControl::MANAGE_HASHLIST_ACCESS]])]]}}
              <form class="d-flex flex-wrap align-items-center gap-2"
                    action="hashlists.php?id=[[list.getVal('hashlist')->getId()]]"
                    method="POST">
                <input type="hidden" name="action" value="[[$DHashlistAction::RENAME_HASHLIST]]">
                <input type="hidden" name="hashlist" value="[[list.getVal('hashlist')->getId()]]">
                <input type="hidden" name="csrf" value="[[csrf]]">

                <input type="text" class="form-control" name="name" value="[[list.getVal('hashlist')->getHashlistName()]]" title="Hashlist Name" style="max-width: 420px;">

                <button type="submit"
                        class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}"
                        data-toggle="tooltip" data-placement="top" title="Save">
                  <i class="fas fa-save" aria-hidden="true"></i>
                </button>
              </form>
            {{ELSE}}
              [[list.getVal('hashlist')->getHashlistName()]]
            {{ENDIF}}
          </td>
        </tr>

        <tr>
          <td>Hashlist Notes</td>
          <td>
            {{IF [[accessControl.hasPermission([[$DAccessControl::MANAGE_HASHLIST_ACCESS]])]]}}
              <form class="d-flex flex-column gap-2"
                    action="hashlists.php?id=[[list.getVal('hashlist')->getId()]]"
                    method="POST">
                <input type="hidden" name="action" value="[[$DHashlistAction::EDIT_NOTES]]">
                <input type="hidden" name="hashlist" value="[[list.getVal('hashlist')->getId()]]">
                <input type="hidden" name="csrf" value="[[csrf]]">

                <textarea class="form-control" rows="4" name="notes" title="Hashlist Notes" placeholder="Write hashlist notes here...">[[list.getVal('hashlist')->getNotes()]]</textarea>

                <div>
                  <button type="submit"
                          class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}"
                          data-toggle="tooltip" data-placement="top" title="Save">
                    <i class="fas fa-save" aria-hidden="true"></i>
                  </button>
                </div>
              </form>
            {{ELSE}}
              <textarea class="form-control" rows="4" disabled>[[list.getVal('hashlist')->getNotes()]]</textarea>
            {{ENDIF}}
          </td>
        </tr>

        <tr>
          <td>Hash type</td>
          <td>[[list.getVal('hashtype')->getDescription()]]</td>
        </tr>

        <tr>
          <td>Using hashcat brain</td>
          <td>
            {{IF [[list.getVal('hashlist')->getBrainId()]]}}
              Yes (Brain Features: [[list.getVal('hashlist')->getBrainFeatures()]])
            {{ELSE}}
              No
            {{ENDIF}}
          </td>
        </tr>

        <tr>
          <td>Format</td>
          <td>
            [[Util::getStaticArray([[list.getVal('hashlist')->getFormat()]], 'formats')]]
            {{IF [[list.getVal('hashlist')->getHexSalt()]] == 1}}
              <span class="text-muted">(salt in hex-format)</span>
            {{ENDIF}}
          </td>
        </tr>

        <tr>
          <td>Hashes</td>
          <td>
            {{IF [[accessControl.hasPermission([[$DAccessControl::VIEW_HASHES_ACCESS]])]]}}
              <a href="hashes.php?hashlist=[[list.getVal('hashlist')->getId()]]">[[list.getVal('hashlist').getHashCount()]]</a>
            {{ELSE}}
              [[list.getVal('hashlist').getHashCount()]]
            {{ENDIF}}
          </td>
        </tr>

        <tr>
          <td>Cracked</td>
          <td>
            {{IF [[accessControl.hasPermission([[$DAccessControl::VIEW_HASHES_ACCESS]])]]}}
              <a href="hashes.php?hashlist=[[list.getVal('hashlist')->getId()]]&filter=cracked">[[list.getVal('hashlist').getCracked()]]</a>
            {{ELSE}}
              [[list.getVal('hashlist').getCracked()]]
            {{ENDIF}}
            <span class="text-muted">([[Util::showperc([[list.getVal('hashlist').getCracked()]], [[list.getVal('hashlist').getHashCount()]])]]%)</span>
          </td>
        </tr>

        <tr>
          <td>Remaining</td>
          <td>
            {{IF [[accessControl.hasPermission([[$DAccessControl::VIEW_HASHES_ACCESS]])]]}}
              <a href="hashes.php?hashlist=[[list.getVal('hashlist')->getId()]]&filter=uncracked">
                [[Util::calculate([[list.getVal('hashlist').getHashCount()]] - [[list.getVal('hashlist').getCracked()]])]]
              </a>
            {{ELSE}}
              [[Util::calculate([[list.getVal('hashlist').getHashCount()]] - [[list.getVal('hashlist').getCracked()]])]]
            {{ENDIF}}
            <span class="text-muted">([[Util::showperc([[list.getVal('hashlist').getHashCount()]] - [[list.getVal('hashlist').getCracked()]], [[list.getVal('hashlist').getHashCount()]])]]%)</span>
          </td>
        </tr>

        <tr>
          <td>Secret</td>
          <td>
            {{IF [[accessControl.hasPermission([[$DAccessControl::MANAGE_HASHLIST_ACCESS]])]]}}
              <form id="hashlistsecret"
                    action="hashlists.php?id=[[list.getVal('hashlist')->getId()]]"
                    method="POST"
                    class="d-inline">
                <input type="hidden" name="hashlist" value="[[list.getVal('hashlist')->getId()]]">
                <input type="hidden" name="action" value="[[$DHashlistAction::SET_SECRET]]">
                <input type="hidden" name="csrf" value="[[csrf]]">
                <input type="hidden" name="secret" value="1">

                <div class="form-check form-switch m-0">
                  <input class="form-check-input"
                         title="Is Secret"
                         type="checkbox"
                         name="secret"
                         value="1"
                         {{IF [[list.getVal('hashlist')->getIsSecret()]] == 1}}checked{{ENDIF}}
                         onChange="document.getElementById('hashlistsecret').submit();">
                  <label class="form-check-label ms-2">Hashlist contains secret data</label>
                </div>
              </form>
            {{ELSE}}
              <div class="form-check form-switch m-0">
                <input class="form-check-input" type="checkbox" disabled {{IF [[list.getVal('hashlist')->getIsSecret()]] == 1}}checked{{ENDIF}}>
                <label class="form-check-label ms-2">Hashlist contains secret data</label>
              </div>
            {{ENDIF}}
          </td>
        </tr>

        <tr>
          <td>Access Group</td>
          <td>
            {{IF [[accessControl.hasPermission([[$DAccessControl::MANAGE_HASHLIST_ACCESS]])]]}}
              <form id="accessgroup"
                    class="d-flex flex-wrap align-items-center gap-2"
                    action="hashlists.php?id=[[list.getVal('hashlist')->getId()]]"
                    method="POST">
                <input type="hidden" name="hashlist" value="[[list.getVal('hashlist')->getId()]]">
                <input type="hidden" name="action" value="[[$DHashlistAction::SET_ACCESS_GROUP]]">
                <input type="hidden" name="csrf" value="[[csrf]]">

                <select name="accessGroupId" class="form-control" style="max-width: 420px;">
                  {{FOREACH group;[[accessGroups]]}}
                    <option value="[[group.getId()]]"{{IF [[group.getId()]] == [[accessGroup.getId()]]}} selected{{ENDIF}}>
                      [[group.getGroupName()]]
                    </option>
                  {{ENDFOREACH}}
                </select>

                <button type="submit" class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}">
                  Change Group
                </button>
              </form>
            {{ELSE}}
              [[accessGroup.getGroupName()]]
            {{ENDIF}}
          </td>
        </tr>

        <tr>
          <td>Actions</td>
          <td>
            <div class="d-flex flex-wrap gap-2">
              {{IF [[list.getVal('hashlist')->getCracked()]] > 0 && [[accessControl.hasPermission([[$DAccessControl::MANAGE_HASHLIST_ACCESS]])]] && [[accessControl.hasPermission([[$DAccessControl::ADD_FILE_ACCESS]])]]}}
                <form action="report.php" method="get" class="d-flex flex-wrap align-items-center gap-2">
                  <input type="hidden" name="hashlistId" value="[[list.getVal('hashlist')->getId()]]">
                  <select name="report" class="form-control" style="max-width: 360px;">
                    {{FOREACH report;[[Util::scanReportDirectory('hashlist', true)]]}}
                      <option value="[[strtolower([[report]])]]">[[report]]</option>
                    {{ENDFOREACH}}
                  </select>
                  <button type="submit" class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}">
                    Download Report
                  </button>
                </form>
              {{ENDIF}}

              {{IF [[accessControl.hasPermission([[$DAccessControl::MANAGE_HASHLIST_ACCESS]])]]}}
                <form action="hashlists.php?id=[[list.getVal('hashlist')->getId()]]" method="post">
                  <input type="hidden" name="action" value="[[$DHashlistAction::CREATE_WORDLIST]]">
                  <input type="hidden" name="hashlist" value="[[list.getVal('hashlist')->getId()]]">
                  <input type="hidden" name="csrf" value="[[csrf]]">
                  <button type="submit" class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}">
                    Generate wordlist
                  </button>
                </form>

                <form action="hashlists.php?id=[[list.getVal('hashlist')->getId()]]" method="post">
                  <input type="hidden" name="action" value="[[$DHashlistAction::EXPORT_HASHLIST]]">
                  <input type="hidden" name="hashlist" value="[[list.getVal('hashlist')->getId()]]">
                  <input type="hidden" name="csrf" value="[[csrf]]">
                  <button type="submit" class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}">
                    Export hashes for pre-crack
                  </button>
                </form>

                <form action="hashlists.php?id=[[list.getVal('hashlist')->getId()]]" method="post">
                  <input type="hidden" name="action" value="[[$DHashlistAction::CREATE_LEFTLIST]]">
                  <input type="hidden" name="hashlist" value="[[list.getVal('hashlist')->getId()]]">
                  <input type="hidden" name="csrf" value="[[csrf]]">
                  <button type="submit" class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}">
                    Export left hashes
                  </button>
                </form>
              {{ENDIF}}

              {{IF [[list.getVal('hashlist')->getCracked()]] < [[list.getVal('hashlist')->getHashCount()]] && [[accessControl.hasPermission([[$DAccessControl::MANAGE_HASHLIST_ACCESS]])]]}}
                <form action="hashlists.php?id=[[list.getVal('hashlist')->getId()]]" method="post">
                  <input type="hidden" name="action" value="[[$DHashlistAction::ZAP_HASHLIST]]">
                  <input type="hidden" name="hashlist" value="[[list.getVal('hashlist')->getId()]]">
                  <input type="hidden" name="csrf" value="[[csrf]]">
                  <button type="submit" class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}">
                    Import pre-cracked hashes
                  </button>
                </form>
              {{ENDIF}}
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

{{IF [[list.getVal('hashlist')->getFormat()]] == 3 && [[sizeof([[sublists]])]]}}
  {%TEMPLATE->hashlists/detail/superhashlist%}
{{ENDIF}}
{{IF [[sizeof([[tasks]])]] > 0}}
  {%TEMPLATE->hashlists/detail/tasks%}
{{ENDIF}}
{{IF [[sizeof([[preTasks]])]] > 0}}
  {%TEMPLATE->hashlists/detail/pretasks%}
{{ENDIF}}
{{IF [[sizeof([[superTasks]])]] > 0}}
  {%TEMPLATE->hashlists/detail/supertasks%}
{{ENDIF}}

{%TEMPLATE->struct/foot%}
