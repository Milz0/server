{%TEMPLATE->struct/head%}
{%TEMPLATE->struct/menu%}

{{IF [[src]] == "chunk"}}
  <h2>Hashes of chunk [[chunk.getId()]]</h2>
{{ENDIF}}
{{IF [[src]] == "task"}}
  <h2>
    Hashes of task
    {{IF [[accessControl.hasPermission([[$DAccessControl::VIEW_TASK_ACCESS]])]]}}
      <a href="tasks.php?id=[[task.getId()]]">[[task.getTaskName()]]</a>
    {{ELSE}}
      [[task.getTaskName()]]
    {{ENDIF}}
  </h2>
{{ENDIF}}
{{IF [[src]] == "hashlist"}}
  <h2>
    Hashes of hashlist
    {{IF [[accessControl.hasPermission([[$DAccessControl::VIEW_HASHLIST_ACCESS]])]]}}
      <a href="hashlists.php?id=[[list.getId()]]">[[list.getHashlistName()]]</a>
    {{ELSE}}
      [[list.getHashlistName()]]
    {{ENDIF}}
  </h2>
{{ENDIF}}

{%TEMPLATE->struct/messages%}

<div class="card mb-3">
  <div class="table-responsive">
    <table class="table table-bordered align-middle mb-0">
      <tbody>
        <tr>
          <th style="width: 180px;">Filter</th>
          <td>
            {{IF [[filtering]] == ""}}
              Cracked + Uncracked
            {{ELSE}}
              [[filtering]]
            {{ENDIF}}
          </td>
        </tr>
        <tr>
          <th>Displaying</th>
          <td>
            {{IF [[displaying]] == ""}}
              Hash + Plain
            {{ELSE}}
              [[displaying]]
            {{ENDIF}}
          </td>
        </tr>
        <tr>
          <td colspan="2">
            <div class="d-flex flex-wrap gap-2 justify-content-center align-items-center my-2">
              <div class="btn-group" role="group" aria-label="Pagination">
                <button
                  class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}"
                  onclick="window.location='hashes.php?[[src]]=[[srcId]]&filter=[[filtering]]&display=[[displaying]]&page=[[previousPage]]'"
                  {{IF [[previousPage]] == -1}}disabled{{ENDIF}}
                >
                  [[Util::calculate([[previousPage]]+1)]] &lt;
                </button>
                <button
                  class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}} active"
                  type="button"
                >
                  Page [[Util::calculate([[currentPage]]+1)]]
                </button>
                <button
                  class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}"
                  onclick="window.location='hashes.php?[[src]]=[[srcId]]&filter=[[filtering]]&display=[[displaying]]&page=[[nextPage]]'"
                  {{IF [[nextPage]] == -1}}disabled{{ENDIF}}
                >
                  &gt; [[Util::calculate([[currentPage]]+1)]]
                </button>
              </div>
            </div>

            <form class="row g-2 justify-content-center align-items-center my-2" action="hashes.php" method="get">
              <input type="hidden" name="[[src]]" value="[[srcId]]">

              <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                <select name="display" class="form-select" title="Display Selection">
                  {{FOREACH display;[[displays]]}}
                    <option value="[[display.getVal('id')]]" {{IF [[display.getVal('id')]] == [[displaying]]}}selected{{ENDIF}}>
                      [[display.getVal('text')]]
                    </option>
                  {{ENDFOREACH}}
                </select>
              </div>

              {{IF [[src]] == "hashlist"}}
                <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                  <select name="filter" class="form-select" title="Filtering">
                    {{FOREACH filter;[[filters]]}}
                      <option value="[[filter.getVal('id')]]" {{IF [[filter.getVal('id')]] == [[filtering]]}}selected{{ENDIF}}>
                        [[filter.getVal('text')]]
                      </option>
                    {{ENDFOREACH}}
                  </select>
                </div>
              {{ENDIF}}

              <div class="col-12 col-sm-auto">
                <button type="submit" class="btn btn-success w-100">Apply</button>
              </div>
            </form>

            <div class="d-flex justify-content-center my-2">
              {{IF [[crackpos]] == 0}}
                <a
                  href="hashes.php?[[src]]=[[srcId]]&filter=[[filtering]]&display=[[displaying]]&page=[[currentPage]]&crackpos=true"
                  class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}"
                >
                  Show Crackpos
                </a>
              {{ELSE}}
                <a
                  href="hashes.php?[[src]]=[[srcId]]&filter=[[filtering]]&display=[[displaying]]&page=[[currentPage]]"
                  class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}}"
                >
                  Hide Crackpos
                </a>
              {{ENDIF}}
            </div>

          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<h3>Matching hashes: [[count]]</h3>

<div class="card mb-3">
  <div class="table-responsive">
    <table class="table table-bordered align-middle mb-0">
      <tbody>
        <tr>
          <td>
            <pre class="mb-0" style="max-height: 400px; overflow: auto;" readonly>[[output]]</pre>
          </td>
        </tr>
        <tr>
          <td>
            <script type="text/javascript">
              function hex2a(hex) {
                var str = '';
                for (var i = 0; i < hex.length; i += 2) {
                  str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
                }
                return str;
              }
            </script>

            <div class="mb-2 fw-bold">HEX converter</div>

            <form class="row g-2 align-items-center" onsubmit="return false;">
              <div class="col-12 col-md-auto">
                <label class="form-label mb-1" for="conv">$HEX[ input ]</label>
                <input type="text" class="form-control" id="conv" title="HEX Input" inputmode="text" autocomplete="off">
              </div>

              <div class="col-12 col-md-auto d-flex align-items-end">
                <div class="me-2 mb-2">$HEX[ ] â†’</div>
              </div>

              <div class="col-12 col-md-auto">
                <label class="form-label mb-1" for="convr">Converted</label>
                <input type="text" class="form-control" id="convr" readonly title="Converted">
              </div>

              <div class="col-12 col-md-auto">
                <button
                  class="btn {{IF [[toggledarkmode]] > 0}}btn-primary{{ELSE}}btn-light{{ENDIF}} w-100"
                  onclick="document.getElementById('convr').value = hex2a(document.getElementById('conv').value);"
                >
                  Convert
                </button>
              </div>
            </form>

          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

{%TEMPLATE->struct/foot%}
