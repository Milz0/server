{%TEMPLATE->struct/head%}
{%TEMPLATE->struct/menu%}

<h2>Cracker Binaries</h2>

{%TEMPLATE->struct/messages%}

<div class="card">
  <div class="table-responsive">
    <table class="table table-bordered align-middle">
      <thead>
        <tr>
          <th style="width: 140px;">Binary Type ID</th>
          <th>Name</th>
          <th style="width: 260px;">Available Versions</th>
          <th style="width: 240px;">Action</th>
        </tr>
      </thead>

      <tbody>
        {{FOREACH binaryType;[[binaryTypes]]}}
          <tr>
            <td>
              <a href="crackers.php?id=[[binaryType.getId()]]">[[binaryType.getId()]]</a>
            </td>

            <td>
              <a href="crackers.php?id=[[binaryType.getId()]]">
                [[htmlentities([[binaryType.getTypeName()]], ENT_QUOTES, "UTF-8")]]
              </a>
            </td>

            <td class="text-break">
              [[versions.getVal([[binaryType.getId()]])]]
            </td>

            <td>
              {{IF [[accessControl.hasPermission([[$DAccessControl::CRACKER_BINARY_ACCESS]])]]}}
                <div class="d-flex gap-2 flex-wrap">
                  <a class="btn btn-primary" href="crackers.php?id=[[binaryType.getId()]]&new=true">
                    Add Version/Binary
                  </a>

                  <form action="crackers.php" method="POST"
                        onSubmit="if (!confirm('Really delete binary type [[htmlentities([[binaryType.getTypeName()]], ENT_QUOTES, 'UTF-8')]]?')) return false;">
                    <input type="hidden" name="action" value="[[$DCrackerBinaryAction::DELETE_BINARY_TYPE]]">
                    <input type="hidden" name="binaryTypeId" value="[[binaryType.getId()]]">
                    <input type="hidden" name="csrf" value="[[csrf]]">
                    <button type="submit" class="btn btn-danger" data-toggle="tooltip" data-placement="top" title="Delete">
                      <i class="fas fa-trash" aria-hidden="true"></i>
                    </button>
                  </form>
                </div>
              {{ENDIF}}
            </td>
          </tr>
        {{ENDFOREACH}}
      </tbody>
    </table>
  </div>
</div>

{%TEMPLATE->struct/foot%}
