{%TEMPLATE->struct/head%}
{%TEMPLATE->struct/menu%}

<h2>All users ([[numUsers]])</h2>

{%TEMPLATE->struct/messages%}

<div class="card">
  <div class="table-responsive">
    <table class="table table-bordered table-hover table-sm align-middle">
      <thead>
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Username</th>
          <th scope="col">Creation date</th>
          <th scope="col">Last login</th>
          <th scope="col">Email</th>
          <th scope="col">Validity</th>
          <th scope="col">Session lifetime</th>
          <th scope="col">Right group</th>
          <th scope="col" class="text-end">Action</th>
        </tr>
      </thead>
      <tbody>
        {{FOREACH entry;[[allUsers]]}}
          <tr>
            <td>[[entry.getVal('user').getId()]]</td>
            <td>[[htmlentities([[entry.getVal('user').getUsername()]], ENT_QUOTES, "UTF-8")]]</td>
            <td>[[date([[config.getVal(DConfig::TIME_FORMAT)]], [[entry.getVal('user').getRegisteredSince()]])]]</td>
            <td>[[date([[config.getVal(DConfig::TIME_FORMAT)]], [[entry.getVal('user').getLastLoginDate()]])]]</td>
            <td class="text-break">[[entry.getVal('user').getEmail()]]</td>
            <td>
              {{IF [[entry.getVal('user').getIsValid()]] == 1}}
                <span class="badge bg-success">Valid</span>
              {{ELSE}}
                <span class="badge bg-secondary">Invalid/Not activated</span>
              {{ENDIF}}
            </td>
            <td>[[entry.getVal('user').getSessionLifetime()]]</td>
            <td>[[entry.getVal('group').getGroupName()]]</td>
            <td class="text-end">
              <a class="btn btn-primary btn-sm"
                 href="users.php?id=[[entry.getVal('user').getId()]]"
                 data-toggle="tooltip" data-placement="top" title="Edit">
                <i class="fas fa-edit" aria-hidden="true"></i>
              </a>
            </td>
          </tr>
        {{ENDFOREACH}}
      </tbody>
    </table>
  </div>
</div>

{%TEMPLATE->struct/foot%}